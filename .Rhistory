list("Move" = "Kb2", "Timestamp" = "0:00:20.7"),
list("Move" = "Kxh4", "Timestamp" = "0:00:07.6"),
list("Move" = "a4", "Timestamp" = "0:00:20.6"),
list("Move" = "Kg5", "Timestamp" = "0:00:07.5"),
list("Move" = "a3", "Timestamp" = "0:00:20.5"),
list("Move" = "h4", "Timestamp" = "0:00:07.2"),
list("Move" = "a2", "Timestamp" = "0:00:20.4"),
list("Move" = "h5", "Timestamp" = "0:00:06.9"),
list("Move" = "a1=Q", "Timestamp" = "0:00:20.3"),
list("Move" = "h6", "Timestamp" = "0:00:06.5"),
list("Move" = "Qh1", "Timestamp" = "0:00:20.1"),
list("Move" = "Kg6", "Timestamp" = "0:00:06.2"),
list("Move" = "Qg1+", "Timestamp" = "0:00:19.3"),
list("Move" = "Kh7", "Timestamp" = "0:00:04.9"),
list("Move" = "Qh2", "Timestamp" = "0:00:18.3"),
list("Move" = "Kg7", "Timestamp" = "0:00:04.2"),
list("Move" = "Kc3", "Timestamp" = "0:00:17.5"),
list("Move" = "h7", "Timestamp" = "0:00:02.9"),
list("Move" = "Qc7+", "Timestamp" = "0:00:16.7"),
list("Move" = "Kg8", "Timestamp" = "0:00:02.2"),
list("Move" = "Qd8+", "Timestamp" = "0:00:14.9"),
list("Move" = "Kg7", "Timestamp" = "0:00:01.7"),
list("Move" = "Qe7+", "Timestamp" = "0:00:14.3"),
list("Move" = "Kg8", "Timestamp" = "0:00:01"),
list("Move" = "Qe8+", "Timestamp" = "0:00:13.8")
),
`2` = list(
list("Move" = "e4", "Timestamp" = "0:03:00"),
list("Move" = "c5", "Timestamp" = "0:02:59.7"),
list("Move" = "Nf3", "Timestamp" = "0:02:59.2"),
list("Move" = "Nc6", "Timestamp" = "0:02:58.9"),
list("Move" = "d4", "Timestamp" = "0:02:58.0"),
list("Move" = "cxd4", "Timestamp" = "0:02:57.4"),
list("Move" = "Nxd4", "Timestamp" = "0:02:56.8"),
list("Move" = "Nf6", "Timestamp" = "0:02:55.3"),
list("Move" = "Nc3", "Timestamp" = "0:02:54.0"),
list("Move" = "e5", "Timestamp" = "0:02:52.9"),
list("Move" = "Nf5", "Timestamp" = "0:02:50.2"),
list("Move" = "exf5", "Timestamp" = "0:02:48.1"),
list("Move" = "d5", "Timestamp" = "0:02:46.6"),
list("Move" = "Nxd4", "Timestamp" = "0:02:45.3"),
list("Move" = "Qxd4", "Timestamp" = "0:02:44.5"),
list("Move" = "dxc6", "Timestamp" = "0:02:42.8"),
list("Move" = "bxc6", "Timestamp" = "0:02:41.2"),
list("Move" = "Bd2", "Timestamp" = "0:02:40.6"),
list("Move" = "Qd4", "Timestamp" = "0:02:39.1"),
list("Move" = "O-O", "Timestamp" = "0:02:37.8"),
list("Move" = "e4", "Timestamp" = "0:02:36.4"),
list("Move" = "Bf4", "Timestamp" = "0:02:34.7"),
list("Move" = "g6", "Timestamp" = "0:02:33.1"),
list("Move" = "Bd3", "Timestamp" = "0:02:31.4"),
list("Move" = "c5", "Timestamp" = "0:02:29.8"),
list("Move" = "Nc4", "Timestamp" = "0:02:28.5"),
list("Move" = "Be3", "Timestamp" = "0:02:27.6"),
list("Move" = "f3", "Timestamp" = "0:02:25.2"),
list("Move" = "Bf2", "Timestamp" = "0:02:23.9"),
list("Move" = "Nxd6+", "Timestamp" = "0:02:22.4"),
list("Move" = "Qxd6", "Timestamp" = "0:02:20.8"),
list("Move" = "Bd5", "Timestamp" = "0:02:18.3"),
list("Move" = "Qf4", "Timestamp" = "0:02:16.5"),
list("Move" = "Bf6", "Timestamp" = "0:02:14.2"),
list("Move" = "f4", "Timestamp" = "0:02:12.7"),
list("Move" = "Nxf5", "Timestamp" = "0:02:10.4"),
list("Move" = "Bxd5", "Timestamp" = "0:02:08.6"),
list("Move" = "Rxd5", "Timestamp" = "0:02:06.5"),
list("Move" = "Rxe5", "Timestamp" = "0:02:04.8"),
list("Move" = "Rxe5", "Timestamp" = "0:02:03.1"),
list("Move" = "Kf6", "Timestamp" = "0:02:01.5"),
list("Move" = "h5", "Timestamp" = "0:01:59.8"),
list("Move" = "Rxe1", "Timestamp" = "0:01:58.4"),
list("Move" = "Kh7", "Timestamp" = "0:01:56.6"),
list("Move" = "Rxe8", "Timestamp" = "0:01:54.8"),
list("Move" = "Rxe8", "Timestamp" = "0:01:53.2"),
list("Move" = "h4", "Timestamp" = "0:01:52.4"),
list("Move" = "h4", "Timestamp" = "0:01:50.6"),
list("Move" = "h3", "Timestamp" = "0:01:48.9"),
list("Move" = "g3", "Timestamp" = "0:01:47.5"),
list("Move" = "Kf3", "Timestamp" = "0:01:46.1"),
list("Move" = "Kf4", "Timestamp" = "0:01:44.9"),
list("Move" = "g5", "Timestamp" = "0:01:43.3"),
list("Move" = "Kg3", "Timestamp" = "0:01:42.1"),
list("Move" = "Kg4", "Timestamp" = "0:01:40.9"),
list("Move" = "h3", "Timestamp" = "0:01:39.2"),
list("Move" = "h2", "Timestamp" = "0:01:37.8"),
list("Move" = "Kg3", "Timestamp" = "0:01:36.4"),
list("Move" = "Kg5", "Timestamp" = "0:01:35.1"),
list("Move" = "Kg5", "Timestamp" = "0:01:34.0"),
list("Move" = "Kg7", "Timestamp" = "0:01:32.8"),
list("Move" = "Kg7", "Timestamp" = "0:01:31.5"),
list("Move" = "Kg8", "Timestamp" = "0:01:29.2"),
list("Move" = "Kg9", "Timestamp" = "0:01:28.1"),
list("Move" = "Kg9", "Timestamp" = "0:01:26.6")
)
)
return(total_seconds)
convert_timestamp_to_seconds <- function(timestamp) {
parts <- unlist(strsplit(timestamp, "[:.]"))  # Split by colon and dot
hours <- as.numeric(parts[1])
minutes <- as.numeric(parts[2])
seconds <- as.numeric(parts[3])
tenths <- as.numeric(parts[4]) / 10  # Convert tenths to seconds
total_seconds <- (hours * 3600) + (minutes * 60) + seconds + tenths
return(total_seconds)
}
# Loop through each game in combined_data
for (i in seq_along(combined_data)) {
# Number of moves for the current game
total_moves <- sum(sapply(combined_data[[i]], function(x) length(x$Timestamp)))
# Variables for time tracking
timepermove_player1 <- c()
timepermove_player2 <- c()
# Extract timestamps for the current game
timestamps <- sapply(combined_data[[i]], function(x) x$Timestamp)
# Convert timestamps to total time in seconds
total_time <- sapply(timestamps, convert_timestamp_to_seconds)
# Loop through moves, adjusting for total_time length
for (move in 1:(length(total_time) - 2)) {  # Adjust to length - 2 for index safety
if (is.na(total_time[move]) || is.na(total_time[move + 2])) {
next  # Skip this iteration if any timestamp is NA
}
# Calculate time spent
time_spent <- total_time[move] - total_time[move + 2]
}
if (move %% 2 == 1) {
# Player 1 (White)
timepermove_player1 <- c(timepermove_player1, time_spent)  # Convert to tenths
} else {
# Player 2 (Black)
timepermove_player2 <- c(timepermove_player2, time_spent)  # Convert to tenths
}
}
timepermove_player1
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
View(merged_data_complete2)
View(result_df)
runApp()
View(merged_data_complete2)
runApp()
View(merged_data_complete)
View(zzztest)
View(merged_data_complete2)
View(result_df)
runApp()
runApp()
View(result_df)
View(merged_data_complete2)
runApp()
sum(is.na(result_df$game_number))  # Count NAs in result_df
sum(is.na(merged_data_complete2$game_number))  # Count NAs in merged_data_complete2
str(result_df$game_number)
str(merged_data_complete2$game_number)
Q
runApp()
runApp()
runApp()
View(merged_data_complete2)
merged_data_complete2$game_number
result_df$game_number
runApp()
runApp()
runApp()
View(result_df_filtered)
runApp()
View(merged_data_complete2)
runApp()
runApp()
View(result_df)
View(result_df2)
runApp()
typeof(result_df2$opponentElo)
typeof(result_df2$game_result_numeric)
typeof(result_df2$time_per_move)
typeof(result_df2$move_number)
typeof(result_df2$Score)
typeof(result_df2$game_number)
runApp()
runApp()
runApp()
typeof(year)
typeof(result_df$year)
typeof(result_df2$year)
runApp()
runApp()
ga_model@solution
ga_model@fitness
ga_model@bestSol
ga_model@elitism
ga_model@optim
ga_model@bestSol
View(ga_model@bestSol)
ga_model@upper
ga_model@suggestions
ga_model@summary
runApp()
ga_model@summary@max
max_summary <- ga_model@summary[ga_model@summary$fitness == max(ga_model@summary$fitness), ]
str(ga_model@summary)
ga_model@summary
runApp()
runApp()
View(best_fitness_values)
View(fitness_plot_data)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
library(keras)
remotes::install_github("rstudio/tensorflow")
library(tensorflow)
install_tensorflow(envname = "r-tensorflow")
runApp()
runApp()
library(keras)
library(keras)
library(keras)
runApp()
reticulate::py_config()
install.packages("keras")
library(keras)
install_keras()
shiny::runApp()
runApp()
runApp()
View(train_x)
runApp()
knitr::opts_chunk$set(echo = TRUE)
# Load necessary libraries
library(reticulate)
library(keras)
library(dplyr)
set.seed(245)
# Define the number of games into the future to predict
future_steps <- 5  # Replace with the desired number of future games
# Create a target variable shifted by the specified number of games
result_df2 <- result_df2 %>%
mutate(future_elo = lead(current_elo, n = future_steps)) %>%
drop_na()  # Remove rows with NA in the future_elo column due to shifting
# Load necessary libraries
library(reticulate)
library(keras)
library(dplyr)
set.seed(245)
# Define the number of games into the future to predict
future_steps <- 5  # Replace with the desired number of future games
# Create a target variable shifted by the specified number of games
result_df2 <- result_df2 %>%
mutate(future_elo = lead(current_elo, n = future_steps)) %>%
drop_na()  # Remove rows with NA in the future_elo column due to shifting
View(result_df)
# Load necessary libraries
library(reticulate)
library(keras)
library(dplyr)
set.seed(245)
# Define the number of games into the future to predict
future_steps <- 5  # Replace with the desired number of future games
# Create a target variable shifted by the specified number of games
result_df <- result_df %>%
mutate(future_elo = lead(current_elo, n = future_steps)) %>%
drop_na()  # Remove rows with NA in the future_elo column due to shifting
# Load necessary libraries
library(reticulate)
library(keras)
library(dplyr)
set.seed(245)
# Define the number of games into the future to predict
future_steps <- 5  # Replace with the desired number of future games
# Split the modified result_df into training and test datasets
data_rows <- floor(0.80 * nrow(result_df))
train_indices <- sample(c(1:nrow(result_df)), data_rows)
train_data <- result_df[train_indices, ]
test_data <- result_df[-train_indices, ]
py_confic()
# Load necessary libraries
library(reticulate)
library(keras)
library(dplyr)
set.seed(245)
# Define the number of games into the future to predict
future_steps <- 5  # Replace with the desired number of future games
# Split the modified result_df into training and test datasets
data_rows <- floor(0.80 * nrow(result_df))
train_indices <- sample(c(1:nrow(result_df)), data_rows)
train_data <- result_df[train_indices, ]
test_data <- result_df[-train_indices, ]
# Normalize features
normalize <- function(x) {
return ((x - min(x)) / (max(x) - min(x)))
}
train_data <- train_data %>%
mutate(across(c(game_result_numeric, opponentElo, Score, move_number, time_per_move, month, week, year), normalize))
# Load necessary libraries
library(reticulate)
library(keras)
library(dplyr)
set.seed(245)
# Define the number of games into the future to predict
future_steps <- 5  # Replace with the desired number of future games
# Split the modified result_df into training and test datasets
data_rows <- floor(0.80 * nrow(result_df))
train_indices <- sample(c(1:nrow(result_df)), data_rows)
train_data <- result_df[train_indices, ]
test_data <- result_df[-train_indices, ]
# Normalize features
normalize <- function(x) {
return ((x - min(x)) / (max(x) - min(x)))
}
train_data <- train_data %>%
mutate(across(c(opponentElo, Score, move_number, time_per_move, month, week, year), normalize))
# Load necessary libraries
library(reticulate)
library(keras)
library(dplyr)
set.seed(245)
# Define the number of games into the future to predict
future_steps <- 5  # Replace with the desired number of future games
# Split the modified result_df into training and test datasets
data_rows <- floor(0.80 * nrow(result_df))
train_indices <- sample(c(1:nrow(result_df)), data_rows)
train_data <- result_df[train_indices, ]
test_data <- result_df[-train_indices, ]
# Normalize features
normalize <- function(x) {
return ((x - min(x)) / (max(x) - min(x)))
}
train_data <- train_data %>%
mutate(across(c(Score, move_number, time_per_move, month, week, year), normalize))
# Load necessary libraries
library(reticulate)
library(keras)
library(dplyr)
set.seed(245)
# Define the number of games into the future to predict
future_steps <- 5  # Replace with the desired number of future games
# Split the modified result_df into training and test datasets
data_rows <- floor(0.80 * nrow(result_df))
train_indices <- sample(c(1:nrow(result_df)), data_rows)
train_data <- result_df[train_indices, ]
test_data <- result_df[-train_indices, ]
# Normalize features
normalize <- function(x) {
return ((x - min(x)) / (max(x) - min(x)))
}
train_data <- train_data %>%
mutate(across(c(month, week, year), normalize))
test_data <- test_data %>%
mutate(across(c(opponentElo, Score, move_number, time_per_move, month, week, year), normalize))
# Load necessary libraries
library(reticulate)
library(keras)
library(dplyr)
set.seed(245)
# Define the number of games into the future to predict
future_steps <- 5  # Replace with the desired number of future games
# Split the modified result_df into training and test datasets
data_rows <- floor(0.80 * nrow(result_df))
train_indices <- sample(c(1:nrow(result_df)), data_rows)
train_data <- result_df[train_indices, ]
test_data <- result_df[-train_indices, ]
# Normalize features
normalize <- function(x) {
return ((x - min(x)) / (max(x) - min(x)))
}
train_data <- train_data %>%
mutate(across(c(month, week, year), normalize))
test_data <- test_data %>%
mutate(across(c(month, week, year), normalize))
# Separate features and target (future_elo)
train_x <- train_data %>% select(-current_elo, -future_elo)
# Load necessary libraries
library(reticulate)
library(keras)
library(dplyr)
set.seed(245)
# Define the number of games into the future to predict
future_steps <- 5  # Replace with the desired number of future games
# Split the modified result_df into training and test datasets
data_rows <- floor(0.80 * nrow(result_df))
train_indices <- sample(c(1:nrow(result_df)), data_rows)
train_data <- result_df[train_indices, ]
test_data <- result_df[-train_indices, ]
# Normalize features
normalize <- function(x) {
return ((x - min(x)) / (max(x) - min(x)))
}
train_data <- train_data %>%
mutate(across(c(month, week, year), normalize))
test_data <- test_data %>%
mutate(across(c(month, week, year), normalize))
# Separate features and target (future_elo)
train_x <- train_data %>% select(-V15, -future_elo)
# Load necessary libraries
library(reticulate)
library(keras)
library(dplyr)
set.seed(245)
# Define the number of games into the future to predict
future_steps <- 5  # Replace with the desired number of future games
# Split the modified result_df into training and test datasets
data_rows <- floor(0.80 * nrow(result_df))
train_indices <- sample(c(1:nrow(result_df)), data_rows)
train_data <- result_df[train_indices, ]
test_data <- result_df[-train_indices, ]
# Normalize features
normalize <- function(x) {
return ((x - min(x)) / (max(x) - min(x)))
}
train_data <- train_data %>%
mutate(across(c(month, week, year), normalize))
test_data <- test_data %>%
mutate(across(c(month, week, year), normalize))
# Separate features and target (future_elo)
train_x <- train_data %>% select(-V15, -V14)
train_y <- train_data$future_elo
test_x <- test_data %>% select(-V15, -V14)
test_y <- test_data$future_elo
# Build the neural network model
model <- keras_model_sequential() %>%
layer_dense(units = 8, activation = "relu", input_shape = ncol(train_x)) %>%
layer_dense(units = 4, activation = "relu") %>%
layer_dense(units = 1)  # Linear output for regression
# Load necessary libraries
library(reticulate)
library(keras)
library(dplyr)
set.seed(245)
# Define the number of games into the future to predict
future_steps <- 5  # Replace with the desired number of future games
# Split the modified result_df into training and test datasets
data_rows <- floor(0.80 * nrow(result_df))
train_indices <- sample(c(1:nrow(result_df)), data_rows)
train_data <- result_df[train_indices, ]
test_data <- result_df[-train_indices, ]
# Normalize features
normalize <- function(x) {
return ((x - min(x)) / (max(x) - min(x)))
}
train_data <- train_data %>%
mutate(across(c(month, week, year), normalize))
test_data <- test_data %>%
mutate(across(c(month, week, year), normalize))
# Separate features and target (future_elo)
train_x <- train_data %>% select(-V15, -V14)
train_y <- train_data$future_elo
test_x <- test_data %>% select(-V15, -V14)
test_y <- test_data$future_elo
# Build the neural network model
model <- keras_model_sequential() %>%
layer_dense(units = 8, activation = "relu", input_shape = ncol(train_x)) %>%
layer_dense(units = 4, activation = "relu") %>%
layer_dense(units = 1)  # Linear output for regression
# Load necessary libraries
library(reticulate)
library(keras)
library(dplyr)
set.seed(245)
# Define the number of games into the future to predict
future_steps <- 5  # Replace with the desired number of future games
# Split the modified result_df into training and test datasets
data_rows <- floor(0.80 * nrow(result_df))
train_indices <- sample(c(1:nrow(result_df)), data_rows)
train_data <- result_df[train_indices, ]
test_data <- result_df[-train_indices, ]
# Normalize features
normalize <- function(x) {
return ((x - min(x)) / (max(x) - min(x)))
}
train_data <- train_data %>%
mutate(across(c(month, week, year), normalize))
test_data <- test_data %>%
mutate(across(c(month, week, year), normalize))
# Separate features and target (future_elo)
train_x <- train_data %>% select(-V15, -V14)
train_y <- train_data$future_elo
test_x <- test_data %>% select(-V15, -V14)
test_y <- test_data$future_elo
# Build the neural network model
model <- keras_model_sequential() %>%
layer_dense(units = 4, activation = "relu", input_shape = ncol(train_x)) %>%
layer_dense(units = 4, activation = "relu") %>%
layer_dense(units = 1)  # Linear output for regression
install.packages("tensorflow")
tensorflow::install_tensorflow()
install.packages("tensorflow")
library(keras)
library(tensorflow)
tf$constant("TensorFlow is working!")
install_tensorflow()
knitr::opts_chunk$set(echo = TRUE)
install_keras()
library(keras)
install_keras()
knitr::opts_chunk$set(echo = TRUE)
#library(keras)
#install_keras()
library(keras)
mnist <- dataset_mnist()
