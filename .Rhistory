# Split the string based on the '+'
split_strings <- strsplit(value, "\\+")[[1]]
# Extract the length of the game for each player in minutes
Length_of_Game_For_Each_Player <- as.numeric(split_strings[1])
# Convert minutes to HH:MM format
time_in_hhmm <- sprintf("%02d:%02d", Length_of_Game_For_Each_Player %/% 60, Length_of_Game_For_Each_Player %% 60)
# Set 'set_value' to the formatted time
set_value <- time_in_hhmm
# Initialize a list to store time per move within the outer loop
timepermoveinterior <- list()
# Initialize a list to store time_class for each move
time_class_interiors <- list()
# Extract all matches of time values in the 'value'
count <- count + 1
matches <- str_extract_all(filtered_data$games$pgn[count], '\\d+:\\d+(?:\\.\\d+|)]')[[1]]
set_value <- time_in_hhmm
set_value1 <- time_in_hhmm
# Get the time_class for the current game
current_time_class <- filtered_data$games$time_class[count]
for (move in 1:length(matches)) {
if (move %% 2 == 0) {
m2 <- as.character(matches[move])
# Convert the string to POSIXct format (minutes and seconds)
NewMatches <- as.POSIXct(m2, format = "%M:%OS")
# Calculate time remaining using a custom function 'subtract_time'
timeRemaining <- subtract_time(set_value, NewMatches)
# Update 'set_value' for the next iteration
set_value <- m2
# Round the time remaining to one decimal place and add it to the interior list
timeRemaining <- round(timeRemaining, digits = 1)
timepermoveinterior <- c(timepermoveinterior, timeRemaining)
time_class_interiors <- c(time_class_interiors, current_time_class)
} else {
if (move == 1) {
m1 <- set_value1
} else {
m1 <- as.character(matches[move])
}
# Convert the string to POSIXct format (minutes and seconds)
NewMatches1 <- as.POSIXct(m1, format = "%M:%OS")
# Calculate time remaining using a custom function 'subtract_time'
timeRemaining <- subtract_time(set_value1, NewMatches1)
# Update 'set_value1' for the next iteration
set_value1 <- m1
# Round the time remaining to one decimal place and add it to the interior list
timeRemaining <- round(timeRemaining, digits = 1)
timepermoveinterior <- c(timepermoveinterior, timeRemaining)
time_class_interiors <- c(time_class_interiors, current_time_class)
}
}
# Add time_per_move and time_class for the current game to the respective lists
timepermove <- c(timepermove, list(timepermoveinterior))
timepermove[[count]]$time_class <- time_class_interiors
}
View(timepermove)
timepermove[[2]]
}
timepermove[[1]]
zzztest <- do.call(rbind, lapply(seq_along(timepermove), function(list_num) {
inner_list <- timepermove[[list_num]]
if (length(inner_list) > 0) {
# Extract the timeRemaining and time_class into vectors
time_remaining <- sapply(inner_list, function(x) x$timeRemaining)
time_class <- sapply(inner_list, function(x) x$time_class)
# Create the data frame
df <- data.frame(
timeRemaining = time_remaining,
move_number = seq_along(time_remaining),
game_number = list_num,
time_class = time_class
)
return(df)
} else {
return(NULL)
}
}))
library(plotly)
library(httr)
library(dplyr)
library(shiny)
library(stringr)
library(tidyr)
library(ggplot2)
library(chron)
library(scales)
library(lubridate)
library(bigchess)
filtered_data <- combined_df %>% filter(games$rules == "chess")
filtered_data <- filtered_data %>% filter(games$rated == "TRUE")
# Create a function that calculates the amount of time spent per move
subtract_time <- function(set_value, variable) {
set_time <- as.POSIXct(set_value, format = "%M:%OS")
set_time <- as.numeric(set_time)
variable_time <- as.POSIXct(variable, format = "%M:%OS")
variable_time <- as.numeric(variable_time)
# Subtract the variable time from the set time
result_time <- set_time - variable_time
# Return the result time
return(result_time)
}
# Initialize lists and counters
timepermove <- list()
count <- 0
# Loop through each game in combined_df
for (value in combined_df$games$time_control) {
# Split the string based on the '+'
split_strings <- strsplit(value, "\\+")[[1]]
# Extract the length of the game for each player in minutes
Length_of_Game_For_Each_Player <- as.numeric(split_strings[1])
# Convert minutes to HH:MM format
time_in_hhmm <- sprintf("%02d:%02d", Length_of_Game_For_Each_Player %/% 60, Length_of_Game_For_Each_Player %% 60)
# Set 'set_value' to the formatted time
set_value <- time_in_hhmm
# Initialize a list to store time per move within the outer loop
timepermoveinterior <- list()
# Initialize a list to store time_class for each move
time_class_interiors <- list()
# Extract all matches of time values in the 'value'
count <- count + 1
matches <- str_extract_all(filtered_data$games$pgn[count], '\\d+:\\d+(?:\\.\\d+|)]')[[1]]
set_value <- time_in_hhmm
set_value1 <- time_in_hhmm
# Get the time_class for the current game
current_time_class <- filtered_data$games$time_class[count]
for (move in 1:length(matches)) {
if (move %% 2 == 0) {
m2 <- as.character(matches[move])
# Convert the string to POSIXct format (minutes and seconds)
NewMatches <- as.POSIXct(m2, format = "%M:%OS")
# Calculate time remaining using a custom function 'subtract_time'
timeRemaining <- subtract_time(set_value, NewMatches)
# Update 'set_value' for the next iteration
set_value <- m2
# Round the time remaining to one decimal place and add it to the interior list
timeRemaining <- round(timeRemaining, digits = 1)
timepermoveinterior <- c(timepermoveinterior, timeRemaining)
time_class_interiors <- c(time_class_interiors, current_time_class)
} else {
if (move == 1) {
m1 <- set_value1
} else {
m1 <- as.character(matches[move])
}
# Convert the string to POSIXct format (minutes and seconds)
NewMatches1 <- as.POSIXct(m1, format = "%M:%OS")
# Calculate time remaining using a custom function 'subtract_time'
timeRemaining <- subtract_time(set_value1, NewMatches1)
# Update 'set_value1' for the next iteration
set_value1 <- m1
# Round the time remaining to one decimal place and add it to the interior list
timeRemaining <- round(timeRemaining, digits = 1)
timepermoveinterior <- c(timepermoveinterior, timeRemaining)
time_class_interiors <- c(time_class_interiors, current_time_class)
}
}
# Add time_per_move and time_class for the current game to the respective lists
timepermove <- c(timepermove, list(timepermoveinterior))
timepermove[[count]]$time_class <- time_class_interiors
}
# Combine all games into zzztest dataframe
zzztest <- do.call(rbind, lapply(seq_along(timepermove), function(list_num) {
inner_list <- timepermove[[list_num]]
if (length(inner_list) > 0) {
# Extract the timeRemaining and time_class into vectors
time_remaining <- sapply(inner_list, function(x) x$timeRemaining)
time_class <- sapply(inner_list, function(x) x$time_class)
# Create the data frame
df <- data.frame(
timeRemaining = time_remaining,
move_number = seq_along(time_remaining),
game_number = list_num,
time_class = time_class
)
return(df)
} else {
return(NULL)
}
}))
# Combine all games into zzztest dataframe
zzztest <- do.call(rbind, lapply(seq_along(timepermove), function(list_num) {
inner_list <- timepermove[[list_num]]
if (length(inner_list) > 0) {
# Extract the timeRemaining and time_class into vectors
time_remaining <- sapply(inner_list, function(x) x$timeRemaining, simplify = FALSE)
time_class <- sapply(inner_list, function(x) x$time_class, simplify = FALSE)
# Create the data frame
df <- data.frame(
timeRemaining = unlist(time_remaining),
move_number = seq_along(time_remaining),
game_number = list_num,
time_class = unlist(time_class)
)
return(df)
} else {
return(NULL)
}
}))
library(plotly)
library(httr)
library(dplyr)
library(shiny)
library(stringr)
library(tidyr)
library(ggplot2)
library(chron)
library(scales)
library(lubridate)
library(bigchess)
filtered_data <- combined_df %>% filter(games$rules == "chess")
filtered_data <- filtered_data %>% filter(games$rated == "TRUE")
# Create a function that calculates the amount of time spent per move
subtract_time <- function(set_value, variable) {
set_time <- as.POSIXct(set_value, format = "%M:%OS")
set_time <- as.numeric(set_time)
variable_time <- as.POSIXct(variable, format = "%M:%OS")
variable_time <- as.numeric(variable_time)
# Subtract the variable time from the set time
result_time <- set_time - variable_time
# Return the result time
return(result_time)
}
# Initialize lists and counters
timepermove <- list()
count <- 0
# Loop through each game in combined_df
for (value in combined_df$games$time_control) {
# Split the string based on the '+'
split_strings <- strsplit(value, "\\+")[[1]]
# Extract the length of the game for each player in minutes
Length_of_Game_For_Each_Player <- as.numeric(split_strings[1])
# Convert minutes to HH:MM format
time_in_hhmm <- sprintf("%02d:%02d", Length_of_Game_For_Each_Player %/% 60, Length_of_Game_For_Each_Player %% 60)
# Set 'set_value' to the formatted time
set_value <- time_in_hhmm
# Initialize a list to store time per move within the outer loop
timepermoveinterior <- list()
# Initialize a list to store time_class for each move
time_class_interiors <- list()
# Extract all matches of time values in the 'value'
count <- count + 1
matches <- str_extract_all(filtered_data$games$pgn[count], '\\d+:\\d+(?:\\.\\d+|)]')[[1]]
set_value <- time_in_hhmm
set_value1 <- time_in_hhmm
# Get the time_class for the current game
current_time_class <- filtered_data$games$time_class[count]
for (move in 1:length(matches)) {
if (move %% 2 == 0) {
m2 <- as.character(matches[move])
# Convert the string to POSIXct format (minutes and seconds)
NewMatches <- as.POSIXct(m2, format = "%M:%OS")
# Calculate time remaining using a custom function 'subtract_time'
timeRemaining <- subtract_time(set_value, NewMatches)
# Update 'set_value' for the next iteration
set_value <- m2
# Round the time remaining to one decimal place and add it to the interior list
timeRemaining <- round(timeRemaining, digits = 1)
timepermoveinterior <- c(timepermoveinterior, timeRemaining)
time_class_interiors <- c(time_class_interiors, current_time_class)
} else {
if (move == 1) {
m1 <- set_value1
} else {
m1 <- as.character(matches[move])
}
# Convert the string to POSIXct format (minutes and seconds)
NewMatches1 <- as.POSIXct(m1, format = "%M:%OS")
# Calculate time remaining using a custom function 'subtract_time'
timeRemaining <- subtract_time(set_value1, NewMatches1)
# Update 'set_value1' for the next iteration
set_value1 <- m1
# Round the time remaining to one decimal place and add it to the interior list
timeRemaining <- round(timeRemaining, digits = 1)
timepermoveinterior <- c(timepermoveinterior, timeRemaining)
time_class_interiors <- c(time_class_interiors, current_time_class)
}
}
# Add time_per_move and time_class for the current game to the respective lists
timepermove <- c(timepermove, list(timepermoveinterior))
timepermove[[count]]$time_class <- time_class_interiors
}
# Combine all games into zzztest dataframe
zzztest <- do.call(rbind, lapply(seq_along(timepermove), function(list_num) {
inner_list <- timepermove[[list_num]]
if (length(inner_list) > 0) {
# Extract the timeRemaining and time_class into vectors
time_remaining <- sapply(inner_list, function(x) x$timeRemaining)
time_class <- sapply(inner_list, function(x) x$time_class)
# Create the data frame
df <- data.frame(
timeRemaining = time_remaining,
move_number = seq_along(time_remaining),
game_number = list_num,
time_class = time_class
)
return(df)
} else {
return(NULL)
}
}))
library(plotly)
library(httr)
library(dplyr)
library(shiny)
library(stringr)
library(tidyr)
library(ggplot2)
library(chron)
library(scales)
library(lubridate)
library(bigchess)
filtered_data <- combined_df %>% filter(games$rules == "chess")
filtered_data <- filtered_data %>% filter(games$rated == "TRUE")
# Create a function that calculates the amount of time spent per move
subtract_time <- function(set_value, variable) {
set_time <- as.POSIXct(set_value, format = "%M:%OS")
set_time <- as.numeric(set_time)
variable_time <- as.POSIXct(variable, format = "%M:%OS")
variable_time <- as.numeric(variable_time)
# Subtract the variable time from the set time
result_time <- set_time - variable_time
# Return the result time
return(result_time)
}
# Initialize lists and counters
timepermove <- list()
count <- 0
# Loop through each game in combined_df
for (value in combined_df$games$time_control) {
# Split the string based on the '+'
split_strings <- strsplit(value, "\\+")[[1]]
# Extract the length of the game for each player in minutes
Length_of_Game_For_Each_Player <- as.numeric(split_strings[1])
# Convert minutes to HH:MM format
time_in_hhmm <- sprintf("%02d:%02d", Length_of_Game_For_Each_Player %/% 60, Length_of_Game_For_Each_Player %% 60)
# Set 'set_value' to the formatted time
set_value <- time_in_hhmm
# Initialize a list to store time per move within the outer loop
timepermoveinterior <- list()
# Initialize a list to store time_class for each move
time_class_interiors <- list()
# Extract all matches of time values in the 'value'
count <- count + 1
matches <- str_extract_all(filtered_data$games$pgn[count], '\\d+:\\d+(?:\\.\\d+|)]')[[1]]
set_value <- time_in_hhmm
set_value1 <- time_in_hhmm
# Get the time_class for the current game
current_time_class <- filtered_data$games$time_class[count]
for (move in 1:length(matches)) {
if (move %% 2 == 0) {
m2 <- as.character(matches[move])
# Convert the string to POSIXct format (minutes and seconds)
NewMatches <- as.POSIXct(m2, format = "%M:%OS")
# Calculate time remaining using a custom function 'subtract_time'
timeRemaining <- subtract_time(set_value, NewMatches)
# Update 'set_value' for the next iteration
set_value <- m2
# Round the time remaining to one decimal place and add it to the interior list
timeRemaining <- round(timeRemaining, digits = 1)
timepermoveinterior <- c(timepermoveinterior, timeRemaining)
time_class_interiors <- c(time_class_interiors, current_time_class)
} else {
if (move == 1) {
m1 <- set_value1
} else {
m1 <- as.character(matches[move])
}
# Convert the string to POSIXct format (minutes and seconds)
NewMatches1 <- as.POSIXct(m1, format = "%M:%OS")
# Calculate time remaining using a custom function 'subtract_time'
timeRemaining <- subtract_time(set_value1, NewMatches1)
# Update 'set_value1' for the next iteration
set_value1 <- m1
# Round the time remaining to one decimal place and add it to the interior list
timeRemaining <- round(timeRemaining, digits = 1)
timepermoveinterior <- c(timepermoveinterior, timeRemaining)
time_class_interiors <- c(time_class_interiors, current_time_class)
}
}
# Add time_per_move and time_class for the current game to the respective lists
timepermove <- c(timepermove, list(timepermoveinterior))
timepermove[[count]]$time_class <- time_class_interiors
}
# Combine all games into zzztest dataframe
zzztest <- do.call(rbind, lapply(seq_along(timepermove), function(list_num) {
inner_list <- timepermove[[list_num]]
if (length(inner_list) > 0) {
df <- as.data.frame(do.call(rbind, inner_list))
df$move_number <- seq_along(df[[1]])
df$game_number <- list_num
df$
df$time_class <- unlist(inner_list$time_class)
return(df)
} else {
return(NULL)
}
}))
zzztest <- do.call(rbind, lapply(seq_along(timepermove), function(list_num) {
inner_list <- timepermove[[list_num]]
if (length(inner_list) > 0) {
df <- data.frame(
time_per_move = unlist(inner_list),
move_number = seq_along(inner_list),
game_number = list_num,
time_class = rep(filtered_data$games$time_class[list_num], length(inner_list))
)
return(df)
} else {
return(NULL)
}
}))
library(plotly)
library(httr)
library(dplyr)
library(shiny)
library(stringr)
library(tidyr)
library(ggplot2)
library(chron)
library(scales)
library(lubridate)
library(bigchess)
filtered_data <- combined_df %>% filter(games$rules == "chess")
filtered_data <- filtered_data %>% filter(games$rated == "TRUE")
# Create a function that calculates the amount of time spent per move
subtract_time <- function(set_value, variable) {
set_time <- as.POSIXct(set_value, format = "%M:%OS")
set_time <- as.numeric(set_time)
variable_time <- as.POSIXct(variable, format = "%M:%OS")
variable_time <- as.numeric(variable_time)
# Subtract the variable time from the set time
result_time <- set_time - variable_time
# Return the result time
return(result_time)
}
# Initialize lists and counters
timepermove <- list()
count <- 0
# Loop through each game in combined_df
for (value in combined_df$games$time_control) {
# Split the string based on the '+'
split_strings <- strsplit(value, "\\+")[[1]]
# Extract the length of the game for each player in minutes
Length_of_Game_For_Each_Player <- as.numeric(split_strings[1])
# Convert minutes to HH:MM format
time_in_hhmm <- sprintf("%02d:%02d", Length_of_Game_For_Each_Player %/% 60, Length_of_Game_For_Each_Player %% 60)
# Set 'set_value' to the formatted time
set_value <- time_in_hhmm
# Initialize a list to store time per move within the outer loop
timepermoveinterior <- list()
# Extract all matches of time values in the 'value'
count <- count + 1
matches <- str_extract_all(filtered_data$games$pgn[count], '\\d+:\\d+(?:\\.\\d+|)]')[[1]]
set_value <- time_in_hhmm
set_value1 <- time_in_hhmm
# Get the time_class for the current game
current_time_class <- filtered_data$games$time_class[count]
for (move in 1:length(matches)) {
if (move %% 2 == 0) {
m2 <- as.character(matches[move])
# Convert the string to POSIXct format (minutes and seconds)
NewMatches <- as.POSIXct(m2, format = "%M:%OS")
# Calculate time remaining using a custom function 'subtract_time'
timeRemaining <- subtract_time(set_value, NewMatches)
# Update 'set_value' for the next iteration
set_value <- m2
# Round the time remaining to one decimal place and add it to the interior list
timeRemaining <- round(timeRemaining, digits = 1)
timepermoveinterior <- c(timepermoveinterior, timeRemaining)
} else {
if (move == 1) {
m1 <- set_value1
} else {
m1 <- as.character(matches[move])
}
# Convert the string to POSIXct format (minutes and seconds)
NewMatches1 <- as.POSIXct(m1, format = "%M:%OS")
# Calculate time remaining using a custom function 'subtract_time'
timeRemaining <- subtract_time(set_value1, NewMatches1)
# Update 'set_value1' for the next iteration
set_value1 <- m1
# Round the time remaining to one decimal place and add it to the interior list
timeRemaining <- round(timeRemaining, digits = 1)
timepermoveinterior <- c(timepermoveinterior, timeRemaining)
}
}
# Add time_per_move and time_class for the current game to the respective lists
timepermove <- c(timepermove, list(timepermoveinterior))
}
# Combine all games into zzztest dataframe
zzztest <- do.call(rbind, lapply(seq_along(timepermove), function(list_num) {
inner_list <- timepermove[[list_num]]
if (length(inner_list) > 0) {
df <- data.frame(
time_per_move = unlist(inner_list),
move_number = seq_along(inner_list),
game_number = list_num,
time_class = rep(filtered_data$games$time_class[list_num], length(inner_list))
)
return(df)
} else {
return(NULL)
}
}))
# Print the first few rows of 'zzztest' to verify
print(head(zzztest))
runApp('GitHub/ChessWebpage')
View(zzztest)
runApp('GitHub/ChessWebpage')
runApp('GitHub/ChessWebpage')
runApp('GitHub/ChessWebpage')
runApp('GitHub/ChessWebpage')
runApp('GitHub/ChessWebpage')
