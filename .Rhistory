summary.aov(res.man)
print('Average BF mass ~ treatment BF')
res.man <- aov(cbind(`Average mass (BF)`) ~ TreatmentBF, data = Data)
summary.aov(res.man)
# Extract the variables
WFMass <- Data$`Average Mass (WF)`
BFTotalMass <- Data$`BF Total`
TreamentWF <- Data$`Treatment WF`
TreatmentBF <- Data$`Treatment BF`
res.man <- aov(cbind(WFMass) ~ `Treatment BF`, data = Data)
print(' WF Mass ~ WF Treatment * BF Treatment')
summary.aov(res.man)
res.man <- aov(cbind(BFTotalMass) ~ `Treatment WF`*`Treatment BF`, data = Data)
print(' BF Mass ~ WF Treatment * BF Treatment')
# Get a summary of the results
summary(res.man)
print('WF MAss & % Survived ~ WF tadpoles * inital Treatment')
res.man <- manova(cbind(WFMass,`% survivability` ) ~ `# WF tapoles`*`Inital Treatment`, data = Data)
summary.manova(res.man)
print('Average bf MAss ~ treatment WF')
res.man <- aov(cbind(`Average mass (BF)`) ~ TreamentWF, data = Data)
summary.aov(res.man)
print('Average wf mass ~ treatment WF')
res.man <- aov(cbind(`Average Mass (WF)`) ~ TreamentWF, data = Data)
summary.aov(res.man)
print('Average BF mass ~ treatment BF')
res.man <- aov(cbind(`Average mass (BF)`) ~ TreatmentBF, data = Data)
summary.aov(res.man)
# Extract the variables
WFMass <- Data$`Average Mass (WF)`
BFTotalMass <- Data$`Average mass (BF)`
TreamentWF <- Data$`Treatment WF`
TreatmentBF <- Data$`Treatment BF`
res.man <- aov(cbind(BFTotalMass) ~ `Treatment wf`, data = Data)
# Extract the variables
WFMass <- Data$`Average Mass (WF)`
BFTotalMass <- Data$`Average mass (BF)`
TreamentWF <- Data$`Treatment WF`
TreatmentBF <- Data$`Treatment BF`
res.man <- aov(cbind(BFTotalMass) ~ `Treament wf`, data = Data)
# Extract the variables
WFMass <- Data$`Average Mass (WF)`
BFTotalMass <- Data$`Average mass (BF)`
TreamentWF <- Data$`Treatment WF`
TreatmentBF <- Data$`Treatment BF`
res.man <- aov(cbind(BFTotalMass) ~ `Treatment WF`, data = Data)
print(' WF Mass ~ WF Treatment * BF Treatment')
summary.aov(res.man)
res.man <- aov(cbind(BFTotalMass) ~ `Treatment WF`*`Treatment BF`, data = Data)
print(' BF Mass ~ WF Treatment * BF Treatment')
# Get a summary of the results
summary(res.man)
print('WF MAss & % Survived ~ WF tadpoles * inital Treatment')
res.man <- manova(cbind(WFMass,`% survivability` ) ~ `# WF tapoles`*`Inital Treatment`, data = Data)
summary.manova(res.man)
print('Average bf MAss ~ treatment WF')
res.man <- aov(cbind(`Average mass (BF)`) ~ TreamentWF, data = Data)
summary.aov(res.man)
print('Average wf mass ~ treatment WF')
res.man <- aov(cbind(`Average Mass (WF)`) ~ TreamentWF, data = Data)
summary.aov(res.man)
print('Average BF mass ~ treatment BF')
res.man <- aov(cbind(`Average mass (BF)`) ~ TreatmentBF, data = Data)
summary.aov(res.man)
# Extract the variables
WFMass <- Data$`Average Mass (WF)`
BFTotalMass <- Data$`Average mass (BF)`
TreamentWF <- Data$`Treatment WF`
TreatmentBF <- Data$`Treatment BF`
res.man <- aov(cbind(BFTotalMass) ~ `Treatment WF`, data = Data)
print(' WF Mass ~ WF Treatment * BF Treatment')
summary.aov(res.man)
res.man <- aov(cbind(BFTotalMass) ~ `Treatment WF`*`Treatment BF`, data = Data)
print(' BF Mass ~ WF Treatment * BF Treatment')
# Get a summary of the results
summary(res.man)
print('WF MAss & % Survived ~ WF tadpoles * inital Treatment')
res.man <- manova(cbind(WFMass,`% survivability` ) ~ `# WF tapoles`*`Inital Treatment`, data = Data)
summary.manova(res.man)
print('Average bf MAss ~ treatment WF')
res.man <- aov(cbind(`Average mass (BF)`) ~ TreamentWF, data = Data)
summary.aov(res.man)
print('Average wf mass ~ treatment WF')
res.man <- aov(cbind(`Average Mass (WF)`) ~ TreamentWF, data = Data)
summary.aov(res.man)
print('Average BF mass ~ treatment BF')
res.man <- aov(cbind(`Average mass (BF)`) ~ TreatmentBF, data = Data)
summary.aov(res.man)
# Extract the variables
WFMass <- Data$`Average Mass (WF)`
BFTotalMass <- Data$`Average mass (BF)`
TreamentWF <- Data$`Treatment WF`
TreatmentBF <- Data$`Treatment BF`
res.man <- aov(cbind(BFTotalMass) ~ `Treatment WF`, data = Data)
summary.aov(res.man)
res.man <- aov(cbind(BFTotalMass) ~ `Treatment WF`*`Treatment BF`, data = Data)
print(' BF Mass ~ WF Treatment * BF Treatment')
# Get a summary of the results
summary(res.man)
print('WF MAss & % Survived ~ WF tadpoles * inital Treatment')
res.man <- manova(cbind(WFMass,`% survivability` ) ~ `# WF tapoles`*`Inital Treatment`, data = Data)
summary.manova(res.man)
print('Average bf MAss ~ treatment WF')
res.man <- aov(cbind(`Average mass (BF)`) ~ TreamentWF, data = Data)
summary.aov(res.man)
print('Average wf mass ~ treatment WF')
res.man <- aov(cbind(`Average Mass (WF)`) ~ TreamentWF, data = Data)
summary.aov(res.man)
print('Average BF mass ~ treatment BF')
res.man <- aov(cbind(`Average mass (BF)`) ~ TreatmentBF, data = Data)
summary.aov(res.man)
knitr::opts_chunk$set(echo = TRUE)
library(readr)
UrMom <- read_csv("Dynamic Ecology/Blue and fin whales Southern California 2014-2015 - Argos data.csv")
View(Blue_and_fin_whales_Southern_California_2014_2015_Argos_data)
library(readr)
UrMom <- read_csv("Dynamic Ecology/Blue and fin whales Southern California 2014-2015 - Argos data.csv")
View(UrMom)
library(readr)
library(ggplot2)
UrMom <- read_csv("Dynamic Ecology/Blue and fin whales Southern California 2014-2015 - Argos data.csv")
ggplot(UrMom, x=UrMom$location-long, y= UrMom$location-lat)+
geom_point()
library(readr)
library(ggplot2)
UrMom <- read_csv("Dynamic Ecology/Blue and fin whales Southern California 2014-2015 - Argos data.csv")
ggplot(Data = UrMom, x=UrMom$location-long, y= UrMom$location-lat)+
geom_point()
library(readr)
library(ggplot2)
UrMom <- read_csv("Dynamic Ecology/Blue and fin whales Southern California 2014-2015 - Argos data.csv")
ggplot(Data = UrMom, x=UrMom$`location-long`, y= UrMom$`location-lat`
)+
geom_point()
ggplot(x=UrMom$`location-long`, y= UrMom$`location-lat`
)+
geom_point()
library(readr)
library(ggplot2)
UrMom <- read_csv("Dynamic Ecology/Blue and fin whales Southern California 2014-2015 - Argos data.csv")
ggplot(x=UrMom$`location-long`, y= UrMom$`location-lat`)+geom_point()
knitr::opts_chunk$set(echo = TRUE)
library(caret)
library(ISLR2)
library(MASS)
library(ggplot2)
library(ggfortify)
library(GGally)
library(class)
library(dplyr)
library(cutpointr)
library(readr)
library(knitr)
library(rgl)
library(tidyr)
library(reshape2)
library(class)
library(glmnet)
Heart <- read_csv("heart.csv")
str(Heart)
set.seed(123)
Heart <- Heart %>%
select(Age, RestBP,RestECG) %>%
mutate(RestECG = factor(RestECG))
mycolors <- c('royalblue1', 'oldlace')
Heart <- Heart %>% mutate(color = mycolors[as.numeric(RestECG)])
hist(data$Age, main = "Age Distribution", xlab = "Age", col = "lightblue")
Heart <- read_csv("heart.csv")
str(Heart)
set.seed(123)
Heart <- Heart %>%
select(Age, RestBP,RestECG) %>%
mutate(RestECG = factor(RestECG))
mycolors <- c('royalblue1', 'oldlace')
Heart <- Heart %>% mutate(color = mycolors[as.numeric(RestECG)])
cor_matrix <- cor(data[, c("Age", "RestBP", "Chol", "MaxHR")])
Heart <- read_csv("heart.csv")
set.seed(123)
Heart <- Heart %>%
select(Age, RestBP,RestECG) %>%
mutate(RestECG = factor(RestECG))
data <- Heart
mycolors <- c('royalblue1', 'oldlace')
Heart <- Heart %>% mutate(color = mycolors[as.numeric(RestECG)])
cor_matrix <- cor(data[, c("Age", "RestBP", "Chol", "MaxHR")])
Heart <- read_csv("heart.csv")
set.seed(123)
Heart <- Heart %>%
select(Age, RestBP,RestECG) %>%
mutate(RestECG = factor(RestECG))
data <- Heart
mycolors <- c('royalblue1', 'oldlace')
Heart <- Heart %>% mutate(color = mycolors[as.numeric(RestECG)])
cor_matrix <- cor(data[, c("Age", "RestBP", "RestECG")])
Heart <- read_csv("heart.csv")
set.seed(123)
Heart <- Heart %>%
select(Age, RestBP,RestECG) %>%
mutate(RestECG = factor(RestECG))
data <- Heart
mycolors <- c('royalblue1', 'oldlace')
Heart <- Heart %>% mutate(color = mycolors[as.numeric(RestECG)])
ggplot(data = melt(cor_matrix), aes(Var1, Var2, fill = value)) +
geom_tile() +
labs(title = "Correlation Heatmap")
Heart <- read_csv("heart.csv")
set.seed(123)
Heart <- Heart %>%
select(Age, RestBP,RestECG) %>%
mutate(RestECG = factor(RestECG))
data <- Heart
mycolors <- c('royalblue1', 'oldlace')
Heart <- Heart %>% mutate(color = mycolors[as.numeric(RestECG)])
barplot(table(Heart$RestBP))
ggpairs(Heart)
sum(is.na(Heart))
plot3d(
x = Heart$Age,
y = Heart$RestBP,
z = Heart$RestECG,
col = Heart$color,
type = 's',  # or 'p' for points
radius = 4,
xlab = "Age", ylab = "RestBP", zlab = "RestECG"
)
data <- Heart
x_train <- as.matrix(train_data[, names(train_data) != "Exang"])
Heart <- read_csv("heart.csv")
set.seed(123)
Heart <- Heart %>%
select(Age, RestBP,RestECG,Exang) %>%
mutate(RestECG = factor(RestECG))
data <- Heart
mycolors <- c('royalblue1', 'oldlace')
Heart <- Heart %>% mutate(color = mycolors[as.numeric(RestECG)])
barplot(table(Heart$RestBP))
ggpairs(Heart)
sum(is.na(Heart))
plot3d(
x = Heart$Age,
y = Heart$RestBP,
z = Heart$RestECG,
col = Heart$color,
type = 's',  # or 'p' for points
radius = 4,
xlab = "Age", ylab = "RestBP", zlab = "RestECG"
)
data <- Heart
set.seed(123)
# Create the train and test sets (70% train, 30% test)
splitIndex <- createDataPartition(data$Exang, p = 0.7, list = FALSE)
train_data <- data[splitIndex, ]
test_data <- data[-splitIndex, ]
x_train <- as.matrix(train_data[, names(train_data) != "Exang"])
y_train <- as.integer(train_data$Exang)
logreg<-system.time({
cv_fit <- cv.glmnet(x_train, y_train, alpha = 1)
optimal_lambda <- cv_fit$lambda.min
lasso_coefficients <- coef(cv_fit, s = optimal_lambda)
logistic_model <- glm(
Exang ~ .,
data = train_data,
family = binomial,
start = as.vector(lasso_coefficients)
)
predictions <- predict(logistic_model, newdata = test_data, type = "response")
numeric_predictions <- as.vector(predictions)
threshold <- 0.5
actual_classes <- test_data$Exang
predicted_classes <- ifelse(numeric_predictions > threshold, 1, 0)
conf_matrix <- table(Actual = actual_classes, Predicted = predicted_classes)
TP <- sum(predicted_classes == 1 & actual_classes == 1)
TN <- sum(predicted_classes == 0 & actual_classes == 0)
FP <- sum(predicted_classes == 1 & actual_classes == 0)
FN <- sum(predicted_classes == 0 & actual_classes == 1)
Sensitivity <- TP / (TP + FN)
Specificity <- TN / (TN + FP)
print(paste("Sensitivity+Specificity:", round(Sensitivity+Specificity, 2)))
})
# Feature scaling (standardization)
scale_features <- function(df) {
return((df - mean(df)) / sd(df))
}
train_data_scaled <- as.data.frame(lapply(train_data[, c("Age", "RestBP", "RestECG")], scale_features))
Heart <- read_csv("heart.csv")
set.seed(123)
Heart <- Heart %>%
select(Age, RestBP,RestECG,Exang) %>%
mutate(RestECG = factor(RestECG))
data <- Heart
mycolors <- c('royalblue1', 'oldlace')
Heart <- Heart %>% mutate(color = mycolors[as.numeric(RestECG)])
barplot(table(Heart$RestBP))
ggpairs(Heart)
sum(is.na(Heart))
plot3d(
x = Heart$Age,
y = Heart$RestBP,
z = Heart$RestECG,
col = Heart$color,
type = 's',  # or 'p' for points
radius = 4,
xlab = "Age", ylab = "RestBP", zlab = "RestECG"
)
data <- Heart
set.seed(123)
# Create the train and test sets (70% train, 30% test)
splitIndex <- createDataPartition(data$Exang, p = 0.7, list = FALSE)
train_data <- data[splitIndex, ]
test_data <- data[-splitIndex, ]
x_train <- as.matrix(train_data[, names(train_data) != "Exang"])
y_train <- as.integer(train_data$Exang)
View(test_data)
View(train_data)
View(test_data)
Heart <- read_csv("heart.csv")
set.seed(123)
Heart <- Heart %>%
select(Age, RestBP,RestECG,Exang) %>%
mutate(RestECG = factor(RestECG))
data <- Heart
barplot(table(Heart$RestBP))
ggpairs(Heart)
sum(is.na(Heart))
set.seed(123)
# Create the train and test sets (70% train, 30% test)
splitIndex <- createDataPartition(data$Exang, p = 0.7, list = FALSE)
train_data <- data[splitIndex, ]
test_data <- data[-splitIndex, ]
x_train <- as.matrix(train_data[, names(train_data) != "Exang"])
y_train <- as.integer(train_data$Exang)
mycolors <- c('royalblue1', 'oldlace')
Heart <- Heart %>% mutate(color = mycolors[as.numeric(RestECG)])
plot3d(
x = Heart$Age,
y = Heart$RestBP,
z = Heart$RestECG,
col = Heart$color,
type = 's',  # or 'p' for points
radius = 4,
xlab = "Age", ylab = "RestBP", zlab = "RestECG"
)
data <- Heart
logreg<-system.time({
cv_fit <- cv.glmnet(x_train, y_train, alpha = 1)
optimal_lambda <- cv_fit$lambda.min
lasso_coefficients <- coef(cv_fit, s = optimal_lambda)
logistic_model <- glm(
Exang ~ .,
data = train_data,
family = binomial,
start = as.vector(lasso_coefficients)
)
predictions <- predict(logistic_model, newdata = test_data, type = "response")
numeric_predictions <- as.vector(predictions)
threshold <- 0.5
actual_classes <- test_data$Exang
predicted_classes <- ifelse(numeric_predictions > threshold, 1, 0)
conf_matrix <- table(Actual = actual_classes, Predicted = predicted_classes)
TP <- sum(predicted_classes == 1 & actual_classes == 1)
TN <- sum(predicted_classes == 0 & actual_classes == 0)
FP <- sum(predicted_classes == 1 & actual_classes == 0)
FN <- sum(predicted_classes == 0 & actual_classes == 1)
Sensitivity <- TP / (TP + FN)
Specificity <- TN / (TN + FP)
print(paste("Sensitivity+Specificity:", round(Sensitivity+Specificity, 2)))
})
View(test_data)
logreg<-system.time({
cv_fit <- cv.glmnet(x_train, y_train, alpha = 1)
optimal_lambda <- cv_fit$lambda.min
lasso_coefficients <- coef(cv_fit, s = optimal_lambda)
logistic_model <- glm(
Exang ~ .,
data = train_data,
family = binomial,
start = as.vector(lasso_coefficients)
)
predictions <- predict(logistic_model, newdata = test_data, type = "response")
numeric_predictions <- as.vector(predictions)
threshold <- 0.5
actual_classes <- test_data$Exang
predicted_classes <- ifelse(numeric_predictions > threshold, 1, 0)
conf_matrix <- table(Actual = actual_classes, Predicted = predicted_classes)
TP <- sum(predicted_classes == 1 & actual_classes == 1)
TN <- sum(predicted_classes == 0 & actual_classes == 0)
FP <- sum(predicted_classes == 1 & actual_classes == 0)
FN <- sum(predicted_classes == 0 & actual_classes == 1)
Sensitivity <- TP / (TP + FN)
Specificity <- TN / (TN + FP)
print(paste("Sensitivity+Specificity:", round(Sensitivity+Specificity, 2)))
})
cv_fit <- cv.glmnet(x_train, y_train, alpha = 1)
logreg<-system.time({
y_train <- as.factor(y_train)
x_train <- as.data.frame(x_train)
cv_fit <- cv.glmnet(x_train, y_train, alpha = 1)
optimal_lambda <- cv_fit$lambda.min
lasso_coefficients <- coef(cv_fit, s = optimal_lambda)
logistic_model <- glm(
Exang ~ .,
data = train_data,
family = binomial,
start = as.vector(lasso_coefficients)
)
predictions <- predict(logistic_model, newdata = test_data, type = "response")
numeric_predictions <- as.vector(predictions)
threshold <- 0.5
actual_classes <- test_data$Exang
predicted_classes <- ifelse(numeric_predictions > threshold, 1, 0)
conf_matrix <- table(Actual = actual_classes, Predicted = predicted_classes)
TP <- sum(predicted_classes == 1 & actual_classes == 1)
TN <- sum(predicted_classes == 0 & actual_classes == 0)
FP <- sum(predicted_classes == 1 & actual_classes == 0)
FN <- sum(predicted_classes == 0 & actual_classes == 1)
Sensitivity <- TP / (TP + FN)
Specificity <- TN / (TN + FP)
print(paste("Sensitivity+Specificity:", round(Sensitivity+Specificity, 2)))
})
y_train <- as.factor(y_train)
x_train <- as.data.frame(x_train)
cv_fit <- cv.glmnet(x_train, y_train, alpha = 1)
optimal_lambda <- cv_fit$lambda.min
lasso_coefficients <- coef(cv_fit, s = 0.5)
y_train <- as.factor(y_train)
x_train <- as.data.frame(x_train)
cv_fit <- cv.glmnet(x_train, y_train, alpha = 1)
y_train <- as.numeric(as.character(y_train))
x_train <- as.data.frame(x_train)
cv_fit <- cv.glmnet(x_train, y_train, alpha = 1)
y_train <- as.numeric(as.character(y_train))
x_train <- as.matrix(x_train)
cv_fit <- cv.glmnet(x_train, y_train, alpha = 1)
y_train <- as.numeric(as.character(y_train))
sapply(x_train, class)
# Convert non-numeric columns to numeric if necessary
x_train <- sapply(x_train, as.numeric)
# Now, create the matrix
x_train_matrix <- as.matrix(x_train)
x_train <- as.matrix(x_train)
cv_fit <- cv.glmnet(x_train, y_train, alpha = 1)
View(x_train)
Heart <- read_csv("heart.csv")
set.seed(123)
Heart <- Heart %>%
select(Age, RestBP,RestECG,Exang) %>%
mutate(RestECG = factor(RestECG))
data <- Heart
barplot(table(Heart$RestBP))
ggpairs(Heart)
sum(is.na(Heart))
set.seed(123)
# Create the train and test sets (70% train, 30% test)
splitIndex <- createDataPartition(data$Exang, p = 0.7, list = FALSE)
train_data <- data[splitIndex, ]
test_data <- data[-splitIndex, ]
x_train <- as.matrix(train_data[, names(train_data) != "Exang"])
y_train <- as.integer(train_data$Exang)
mycolors <- c('royalblue1', 'oldlace')
Heart <- Heart %>% mutate(color = mycolors[as.numeric(RestECG)])
plot3d(
x = Heart$Age,
y = Heart$RestBP,
z = Heart$RestECG,
col = Heart$color,
type = 's',  # or 'p' for points
radius = 4,
xlab = "Age", ylab = "RestBP", zlab = "RestECG"
)
data <- Heart
cv_fit <- cv.glmnet(x_train, y_train, alpha = 1)
x_train <- as.matrix(train_data[, names(train_data) != "Exang"])
y_train <- as.integer(train_data$Exang)
cv_fit <- cv.glmnet(x_train, y_train, alpha = 1)
shiny::runApp('GitHub/ChessWebpage')
# Function to extract values from the PGN string
extract_pgn_values <- function(pgn, num_values = 21) {
input_text <- paste(pgn, collapse = " ")
matches <- str_extract_all(input_text, "\\[(.*?)\\]")[[1]][1:num_values]
return(matches)
}
# Function to clean date values
clean_dates <- function(dates) {
return(as.Date(gsub("\\[Date \"|\"\\]", "", dates), format = "%Y.%m.%d"))
}
# Function to clean result values
clean_results <- function(results) {
return(regmatches(results, regexpr("\\d+/\\d+-\\d+/\\d+|\\d+-\\d+", results))[[1]])
}
# Function to clean Elo values
clean_elo <- function(elo) {
return(as.numeric(gsub("\\D", "", elo)))
}
# Function to clean time values
clean_time <- function(time) {
return(hms::as_hms(regmatches(time, regexpr("\\d{2}:\\d{2}:\\d{2}", time))[[1]]))
}
# Function to clean usernames
clean_usernames <- function(user_string) {
return(sub("\\[.*?\"(.*?)\"\\]", "\\1", user_string))
}
chess_username <- "owej9023"
desired_rows <- 5000000
game_types <- c("Blitz","Bullet")
api_url <- paste0("https://api.chess.com/pub/player/", chess_username, "/games/archives")
archives <- jsonlite::fromJSON(content(GET(api_url), "text"))
# Fetch and combine game data from all archives
total_archives <- length(archives$archives)
for (i in seq_along(archives$archives)) {
archive_data[[i]] <- jsonlite::fromJSON(content(GET(archives$archives[i]), "text", flatten = TRUE))
}
runApp('GitHub/ChessWebpage')
